<div class="page-layout">
  <!-- Background decorativo -->
  <div class="background-decoration">
    <div class="shape shape-1"></div>
    <div class="shape shape-2"></div>
    <div class="shape shape-3"></div>
  </div>

  <div class="page-content">
    <!-- Logo e título -->
    <div class="brand-section">
      <div class="brand-logo">
        <mat-icon>work</mat-icon>
      </div>
      <h1 class="brand-title">BARBER7</h1>
      <p class="brand-subtitle">Cadastro de Profissional</p>
    </div>

    <!-- Card de registro -->
    <div class="form-card professional-card">
      <div class="form-header">
        <h2 class="form-title">Junte-se à Nossa Equipe</h2>
        <p class="form-subtitle">Cadastre-se como profissional</p>
      </div>

      <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="form-container">
        <!-- Dados Pessoais -->
        <div class="form-section">
          <h3 class="section-title">
            <mat-icon>person</mat-icon>
            Dados Pessoais
          </h3>

          <!-- Nome -->
          <div class="form-group">
            <div class="input-wrapper">
              <input 
                type="text" 
                id="nome"
                formControlName="nome" 
                placeholder="Nome completo"
                class="form-input"
                [class.error]="registerForm.get('nome')?.errors && registerForm.get('nome')?.touched">
            </div>
            <div class="error-text" *ngIf="registerForm.get('nome')?.errors && registerForm.get('nome')?.touched">
              {{ getErrorMessage('nome') }}
            </div>
          </div>

          <!-- Email -->
          <div class="form-group">
            <div class="input-wrapper">
              <input 
                type="email" 
                id="email"
                formControlName="email" 
                placeholder="E-mail"
                class="form-input"
                [class.error]="registerForm.get('email')?.errors && registerForm.get('email')?.touched">
            </div>
            <div class="error-text" *ngIf="registerForm.get('email')?.errors && registerForm.get('email')?.touched">
              {{ getErrorMessage('email') }}
            </div>
          </div>

          <!-- Telefone -->
          <div class="form-group">
            <div class="input-wrapper">
              <input 
                type="tel" 
                id="telefone"
                formControlName="telefone" 
                placeholder="Telefone (00) 00000-0000"
                class="form-input"
                (input)="onPhoneInput($event)"
                maxlength="15"
                [class.error]="registerForm.get('telefone')?.errors && registerForm.get('telefone')?.touched">
            </div>
            <div class="error-text" *ngIf="registerForm.get('telefone')?.errors && registerForm.get('telefone')?.touched">
              {{ getErrorMessage('telefone') }}
            </div>
          </div>
        </div>

        <!-- Dados Profissionais -->
        <div class="form-section">
          <h3 class="section-title">
            <mat-icon>work</mat-icon>
            Dados Profissionais
          </h3>

          <!-- Especialidade -->
          <div class="form-group">
            <label for="especialidade" class="form-label">Especialidades</label>
            <select 
              id="especialidade"
              formControlName="especialidade" 
              class="form-input"
              multiple
              size="5"
              [class.error]="registerForm.get('especialidade')?.errors && registerForm.get('especialidade')?.touched">
              <option *ngFor="let specialty of specialties" [value]="specialty">
                {{ specialty }}
              </option>
            </select>
            <div class="error-text" *ngIf="registerForm.get('especialidade')?.errors && registerForm.get('especialidade')?.touched">
              {{ getErrorMessage('especialidade') }}
            </div>
            <small class="form-hint">Segure Ctrl/Cmd para selecionar múltiplas especialidades</small>
          </div>
        </div>

        <!-- Segurança -->
        <div class="form-section">
          <h3 class="section-title">
            <mat-icon>lock</mat-icon>
            Segurança
          </h3>

          <!-- Senha -->
          <div class="form-group">
            <div class="input-wrapper">
              <input 
                [type]="hidePassword ? 'password' : 'text'"
                id="senha"
                formControlName="senha" 
                placeholder="Senha"
                class="form-input"
                [class.error]="registerForm.get('senha')?.errors && registerForm.get('senha')?.touched">
              <button 
                type="button" 
                class="toggle-btn"
                (click)="hidePassword = !hidePassword">
                <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
              </button>
            </div>
            <div class="error-text" *ngIf="registerForm.get('senha')?.errors && registerForm.get('senha')?.touched">
              {{ getErrorMessage('senha') }}
            </div>
          </div>

          <!-- Confirmar Senha -->
          <div class="form-group">
            <div class="input-wrapper">
              <input 
                [type]="hideConfirmPassword ? 'password' : 'text'"
                id="confirmPassword"
                formControlName="confirmPassword" 
                placeholder="Confirmar senha"
                class="form-input"
                [class.error]="(registerForm.get('confirmPassword')?.errors && registerForm.get('confirmPassword')?.touched) || 
                             (registerForm.errors?.['passwordMismatch'] && registerForm.get('confirmPassword')?.touched)">
              <button 
                type="button" 
                class="toggle-btn"
                (click)="hideConfirmPassword = !hideConfirmPassword">
                <mat-icon>{{ hideConfirmPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
              </button>
            </div>
            <div class="error-text" *ngIf="(registerForm.get('confirmPassword')?.errors && registerForm.get('confirmPassword')?.touched) || 
                                           (registerForm.errors?.['passwordMismatch'] && registerForm.get('confirmPassword')?.touched)">
              {{ getErrorMessage('confirmPassword') }}
            </div>
          </div>
        </div>

        <!-- Mensagem de erro global -->
        <div class="message error" *ngIf="errorMessage">
          <mat-icon>error</mat-icon>
          <span>{{ errorMessage }}</span>
        </div>

        <!-- Botão de cadastro -->
        <button 
          type="submit" 
          class="btn w-100"
          [disabled]="registerForm.invalid || isLoading"
          [class.loading]="isLoading">
          <mat-icon *ngIf="isLoading" class="loading-icon">refresh</mat-icon>
          <span>{{ isLoading ? 'Cadastrando...' : 'Cadastrar como Profissional' }}</span>
        </button>

        <!-- Links -->
        <div class="text-center mt-3">
          <p class="text-muted mb-2">Já tem uma conta? 
            <a routerLink="/auth/login" class="link">Faça login aqui</a>
          </p>
          <p class="text-muted mb-0">É cliente? 
            <a routerLink="/auth/register-client" class="link">Cadastre-se como cliente</a>
          </p>
        </div>
      </form>
    </div>
  </div>
</div>